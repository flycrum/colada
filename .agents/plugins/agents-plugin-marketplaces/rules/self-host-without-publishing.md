# Self-host without publishing

- Repo uses a single env-gated script (`scripts/sync-claude-marketplace.js`) to create/update or remove only our marketplace fields; no publish step. No manual steps for developers except opt-in via `ENABLE_LOCAL_AGENT_CLAUDE=true` in .envrc.local ([automatic-only-opt-in.md](./automatic-only-opt-in.md))
- Adding a plugin: add `.agents/plugins/<name>/` with `.cursor-plugin/plugin.json` and `.claude-plugin/plugin.json`; script discovers plugins by scanning for `.claude-plugin/plugin.json` and picks up the new plugin automatically (no hand-edit of marketplace list; next pnpm install updates marketplace and enabledPlugins). **Excluded:** `_plugin-example` is never included in any marketplace manifest (Claude today; Cursor when it gets local marketplace support); sync script uses `PLUGINS_EXCLUDED_FROM_MARKETPLACE`
- Clean slate: when `ENABLE_LOCAL_AGENT_CLAUDE=false`, script surgically removes our fields or deletes the file if it was entirely ours; toggling on/off leaves no leftover state
