# Automatic flow; only opt-in is manual

- **Requirement:** No part of getting the agent marketplace up and running may be manual except the single opt-in: e.g. the developer sets `ENABLE_LOCAL_AGENT_CLAUDE=true` (i.e. in [.envrc.local](../../../../../.envrc.local), copied from [.env.example](../../../../../.env.example)). That is the only 1% the developer must do.
- **Everything else must be automatic:** Postinstall runs [scripts/sync-claude-marketplace.js](../../../../../scripts/sync-claude-marketplace.js), which creates/updates `.claude-plugin/marketplace.json` and `.claude/settings.json` with `extraKnownMarketplaces` and `enabledPlugins` for all discovered plugins. New plugins are discovered by scanning `.agents/plugins/*/.claude-plugin/plugin.json`â€”no hand-maintained list, no manual `/plugin marketplace add` or `/plugin install` steps. Opening the project in Claude Code uses the generated config; developers must not be asked to run slash commands or track when new plugins are added.
- **Disable:** Setting `ENABLE_LOCAL_AGENT_CLAUDE=false` and running `pnpm install` again removes our fields (clean slate). No manual teardown.
